<!DOCTYPE html>
<html>
<head>
    <title>Dental Analysis Results</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            margin: 0;
            font-size: 28px;
        }
        .subtitle {
            font-size: 16px;
            opacity: 0.8;
            margin-top: 5px;
        }
        .results-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
        }
        .image-results {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .result-card {
            flex: 1;
            min-width: 250px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        .result-card img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            background-color: #f9f9f9;
            border-bottom: 1px solid #e0e0e0;
        }
        .result-details {
            padding: 15px;
        }
        .result-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0 0 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .result-title i {
            color: #3498db;
        }
        .result-item {
            margin-bottom: 5px;
            font-size: 14px;
        }
        .result-value {
            font-weight: 600;
            color: #2c3e50;
        }
        .confidence {
            display: inline-block;
            padding: 3px 8px;
            background-color: #e1f5fe;
            color: #0288d1;
            border-radius: 4px;
            font-size: 13px;
        }
        .ai-diagnosis {
            margin-top: 30px;
        }
        h2 {
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h2 i {
            color: #3498db;
        }
        h3 {
            color: #34495e;
            font-size: 18px;
            margin: 20px 0 10px 0;
        }
        .diagnosis-section {
            margin-bottom: 25px;
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 15px;
        }
        .finding-item, .diagnosis-item, .treatment-item, .preventative-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        .finding-item:last-child, .diagnosis-item:last-child, .treatment-item:last-child, .preventative-item:last-child {
            border-bottom: none;
        }
        .item-header {
            font-weight: 600;
            color: #34495e;
            margin-bottom: 5px;
        }
        .item-details {
            color: #5d6d7e;
            margin-left: 15px;
            font-size: 14px;
        }
        .back-button {
            display: inline-block;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 4px;
            margin-top: 20px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .back-button:hover {
            background-color: #2980b9;
        }
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 5px;
        }
        .badge-high {
            background-color: #e74c3c;
            color: white;
        }
        .badge-medium {
            background-color: #f39c12;
            color: white;
        }
        .badge-low {
            background-color: #3498db;
            color: white;
        }
        .evidence-list {
            margin-top: 5px;
            margin-left: 15px;
            font-size: 13px;
            color: #7f8c8d;
        }
        .timeline {
            font-style: italic;
            color: #7f8c8d;
            font-size: 13px;
            margin-top: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 14px;
        }
        .error-message {
            background-color: #ffe0e0;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            color: #c0392b;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Dental Analysis Results</h1>
            <div class="subtitle">AI-powered diagnostic insights</div>
        </div>
    </header>
    
    <div class="container">
        <div class="results-section">
            <h2><i class="fas fa-image"></i> Model Predictions</h2>
            
            <div class="image-results">
                <div class="result-card">
                    <img src="/{{ dental_image }}" alt="Dental X-Ray">
                    <div class="result-details">
                        <div class="result-title">
                            <i class="fas fa-x-ray"></i> Dental X-Ray Analysis
                        </div>
                        <div class="result-item">
                            Detected condition: <span class="result-value">{{ dental_predicted_class }}</span>
                        </div>
                        <div class="result-item">
                            Confidence: <span class="confidence">{{ dental_confidence }}%</span>
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <img src="/{{ oral_image }}" alt="Oral Disease">
                    <div class="result-details">
                        <div class="result-title">
                            <i class="fas fa-tooth"></i> Oral Disease Analysis
                        </div>
                        <div class="result-item">
                            Detected condition: <span class="result-value">{{ oral_predicted_class }}</span>
                        </div>
                        <div class="result-item">
                            Confidence: <span class="confidence">{{ oral_confidence }}%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="ai-diagnosis">
                <h2><i class="fas fa-brain"></i> Comprehensive AI Analysis</h2>
                
                {% if diagnosis_data.error is defined %}
                <div class="error-message">
                    <strong>Error retrieving AI diagnosis:</strong> {{ diagnosis_data.error }}
                </div>
                {% else %}
                
                <!-- Clinical Findings Section -->
                <div class="diagnosis-section">
                    <h3><i class="fas fa-search"></i> Clinical Findings</h3>
                    {% for finding in diagnosis_data.clinical_findings %}
                    <div class="finding-item">
                        <div class="item-header">{{ finding.observation }}</div>
                        <div class="item-details">
                            <div><strong>Significance:</strong> {{ finding.significance }}</div>
                            <div><strong>Confidence:</strong> {{ finding.confidence }}%</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Diagnosis Section -->
                <div class="diagnosis-section">
                    <h3><i class="fas fa-clipboard-list"></i> Diagnosis</h3>
                    {% for diagnosis in diagnosis_data.diagnosis %}
                    <div class="diagnosis-item">
                        <div class="item-header">
                            {{ diagnosis.condition }}
                            {% if diagnosis.severity == "High" %}
                                <span class="badge badge-high">{{ diagnosis.severity }}</span>
                            {% elif diagnosis.severity == "Medium" %}
                                <span class="badge badge-medium">{{ diagnosis.severity }}</span>
                            {% else %}
                                <span class="badge badge-low">{{ diagnosis.severity }}</span>
                            {% endif %}
                        </div>
                        <div class="item-details">
                            <div><strong>Certainty:</strong> {{ diagnosis.certainty }}</div>
                            <div>
                                <strong>Supporting Evidence:</strong>
                                <ul class="evidence-list">
                                    {% for evidence in diagnosis.supporting_evidence %}
                                    <li>{{ evidence }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Treatment Plan Section -->
                <div class="diagnosis-section">
                    <h3><i class="fas fa-notes-medical"></i> Treatment Plan</h3>
                    {% for treatment in diagnosis_data.treatment_plan %}
                    <div class="treatment-item">
                        <div class="item-header">{{ treatment.intervention }}</div>
                        <div class="item-details">
                            <div><strong>Priority:</strong> {{ treatment.priority }}</div>
                            <div><strong>Expected Outcome:</strong> {{ treatment.expected_outcome }}</div>
                            <div class="timeline"><i class="fas fa-clock"></i> {{ treatment.timeline }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Preventative Measures Section -->
                <div class="diagnosis-section">
                    <h3><i class="fas fa-shield-alt"></i> Preventative Measures</h3>
                    {% for measure in diagnosis_data.preventative_measures %}
                    <div class="preventative-item">
                        <div class="item-header">{{ measure.recommendation }}</div>
                        <div class="item-details">
                            <div><strong>Rationale:</strong> {{ measure.rationale }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Follow Up Section -->
                <div class="diagnosis-section">
                    <h3><i class="fas fa-calendar-check"></i> Follow-up Plan</h3>
                    <div class="item-header">Timeline: {{ diagnosis_data.follow_up.timeline }}</div>
                    <div class="item-details">
                        <div><strong>Specific Monitoring:</strong></div>
                        <ul class="evidence-list">
                            {% for monitoring in diagnosis_data.follow_up.specific_monitoring %}
                            <li>{{ monitoring }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                
                {% endif %}
                
                <a href="/" class="back-button"><i class="fas fa-arrow-left"></i> Analyze Another Set of Images</a>
            </div>
        </div>
        
        <div class="footer">
            <p>This AI analysis tool is for educational and informational purposes only.</p>
            <p>Always consult with a qualified dental professional for diagnosis and treatment.</p>
        </div>
    </div>
</body>
</html>